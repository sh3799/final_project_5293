---
title: "code"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Import and modify Data

```{r}
library(tidyverse)
library(stringr)
res <- read_csv(
  "restaurant_data.csv",
  col_types = cols(
    `INSPECTION DATE` = col_date(format = "%m / %d / %Y"),
    `GRADE DATE` = col_date(format = "%m / %d / %Y"),
    `RECORD DATE` = col_date(format = "%m / %d / %Y")
  )
) %>% na.omit(res)
# replace names that are too long
res$`CUISINE DESCRIPTION` <-
  gsub(
    "Latin \\(Cuban, Dominican, Puerto Rican, South & Central American\\)",
    "Latin",
    res$`CUISINE DESCRIPTION`
  )

res$`CUISINE DESCRIPTION` <-
  gsub(
    "Bottled beverages, including water, sodas, juices, etc.",
    "Bottled beverages",
    res$`CUISINE DESCRIPTION`
  )

# Latest record for same restaurant
res_one <-
  arrange(res, desc(`GRADE DATE`)) %>% distinct(CAMIS, .keep_all = TRUE)
```

cleveland dot plot of cuisine type by borough

```{r}
res_borough <- res_one[,c(3,8)] 
res_borough$count <- rep(1,nrow(res_borough))
res_borough_t <- res_borough %>% group_by(`BORO`,`CUISINE DESCRIPTION`) %>% mutate(count=n()) %>% distinct()

ggplot(res_borough_t,aes(x=count,
                  y=fct_reorder2(`CUISINE DESCRIPTION`,BORO=="MANHATTAN",-count),
                  color=BORO)
                  )+  
  geom_point()+ylab("")



```

Exploring cuisine types and geolocations

```{r}
# remove repeated record for same restaurant
res_unique <- res[, 1:8] %>% distinct()
# Keep only the latest grading for each restaurant

# Subsetting for restaurant near columbia
res_columbia <- filter(res_one,
                       res_one$ZIPCODE == 10025 |
                         res_one$ZIPCODE == 10026 |
                         res_one$ZIPCODE == 10027)
res_columbia_sum <-
  res_columbia %>% group_by(`CUISINE DESCRIPTION`) %>% summarize(total =
                                                                   n()) %>% arrange(desc(total))
# histogram
ggplot(res_columbia_sum) +
  geom_histogram(aes(x = reorder(`CUISINE DESCRIPTION`, total), y = total), stat = "identity") +
  coord_flip()
# cleveland dot plot
ggplot(res_columbia_sum) +
  geom_point(aes(x = reorder(`CUISINE DESCRIPTION`, total), y = total), stat = "identity") +
  coord_flip()

#eg1: American cuisine
American<- filter(res_columbia, res_columbia$`CUISINE DESCRIPTION` =="American")
# Install
install.packages("tm")  # for text mining
install.packages("SnowballC") # for text stemming
install.packages("wordcloud2") # word-cloud generator 
install.packages("RColorBrewer") # color palettes
# Load
library("tm")
library("SnowballC")
library("wordcloud2")
library("RColorBrewer")
American.names<-unique(American$DBA)
res<-rquery.wordcloud(filePath, type ="file", lang = "english")
wordcloud2(demoFreq)
#data<-American %>% %>%mutate(Freq=n())
```

starbucks and shake shack

```{r}
#starbucks
sb <- res %>% filter(res$DBA == "STARBUCKS") %>% group_by(CAMIS)
shops_sb <- summarize(sb, shops = n())

#shake shack
ss <- res %>% filter(res$DBA == "SHAKE SHACK") %>% group_by(CAMIS)
shops_ss <- summarize(ss, shops = n())


```

